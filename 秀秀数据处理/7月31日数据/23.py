import pandas as pd
import os
path='C:\\Users\Administrator\Desktop\秀秀数据\待做\\731数据'
df=pd.read_excel(os.path.join(path,'23.xlsx'),usecols=[0,1,2],header=None,skiprows=3,dtype=object,names=['证券代码','截止日期','会计师事务所'])
df.loc[:,'截止日期']=pd.to_datetime(df['截止日期'])

def get_score(x):
    if x['会计师事务所']=='立信会计师事务所':
        return 80
    if x['会计师事务所']=='天健会计师事务所':
        return 100
    if x['会计师事务所']=='瑞华会计师事务所':
        return 0
    if x['会计师事务所']=='大华会计师事务所(特殊普通合伙)':
        return 80
    if x['会计师事务所']=='信永中和会计师事务所(特殊普通合伙)':
        return 80
    if x['会计师事务所']=='致同会计师事务所':
        return 80
    if x['会计师事务所']=='大信会计师事务所':
        return 80
    if x['会计师事务所']=='天职国际会计师事务所有限公司':
        return 80
    if x['会计师事务所']=='容诚会计师事务所(特殊普通合伙)':
        return 80
    if x['会计师事务所']=='中审众环会计师事务所(特殊普通合伙)':
        return 80
    if x['会计师事务所']=='普华永道中天会计师事务所有限公司':
        return 100
    if x['会计师事务所']=='安永华明会计师事务所':
        return 100
    if x['会计师事务所']=='德勤华永会计师事务所有限公司':
        return 100
    if x['会计师事务所']=='天衡会计师事务所':
        return 60
    if x['会计师事务所']=='众华会计师事务所(特殊普通合伙)':
        return 60
    if x['会计师事务所']=='广东正中珠江会计师事务所':
        return 60
    if x['会计师事务所']=='江苏公证天业会计师事务所':
        return 60
    if x['会计师事务所']=='中汇会计师事务所':
        return 60
    if x['会计师事务所']=='北京兴华会计师事务所(特殊普通合伙)':
        return 60
    if x['会计师事务所']=='毕马威华振会计师事务所':
        return 100
    if x['会计师事务所']=='山东正源和信有限责任会计师事务所':
        return 0
    if x['会计师事务所']=='中瑞岳华会计师事务所':
        return 0
    if x['会计师事务所']=='中兴华会计师事务所有限责任公司':
        return 60
    if x['会计师事务所']=='福建华兴会计师事务所有限公司':
        return 60
    if x['会计师事务所']=='中天运会计师事务所有限公司':
        return 60
    if x['会计师事务所']=='中勤万信会计师事务所(特殊普通合伙)':
        return 40
    if x['会计师事务所']=='上海上会会计师事务所有限公司':
        return 60
    if x['会计师事务所']=='中喜会计师事务所(特殊普通合伙)':
        return 40
    if x['会计师事务所']=='四川华信(集团)会计师事务所':
        return 40
    if x['会计师事务所']=='中兴财光华会计师事务所':
        return 80
    if x['会计师事务所']=='希格玛会计师事务所':
        return 60
    if x['会计师事务所']=='中审华寅五洲会计师事务所(特殊普通合伙)':
        return 0
    if x['会计师事务所']=='亚太(集团)会计师事务所':
        return 60
    if x['会计师事务所']=='中审亚太会计师事务所(特殊普通合伙)':
        return 60
    if x['会计师事务所']=='中准会计师事务所':
        return 40
    if x['会计师事务所']=='利安达会计师事务所':
        return 40
    if x['会计师事务所']=='北京永拓会计师事务所':
        return 60
    if x['会计师事务所']=='江苏苏亚金诚会计师事务所':
        return 60
    if x['会计师事务所']=='北京中证天通会计师事务所':
        return 40
    if x['会计师事务所']=='天健正信会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='深圳市鹏城会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='立信中联会计师事务所':
        return 40
    if x['会计师事务所']=='中审国际会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='中磊会计师事务所有限责任公司':
        return 0
    if x['会计师事务所']=='北京天圆全会计师事务所':
        return 40
    if x['会计师事务所']=='山东汇德会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='山东天恒信有限责任会计师事务所':
        return 0
    if x['会计师事务所']=='天圆全会计师事务所(特殊普通合伙)':
        return 40
    if x['会计师事务所']=='普华永道会计师事务所':
        return 100
    if x['会计师事务所']=='上海东华会计师事务所':
        return 0
    if x['会计师事务所']=='中兴华富华会计师事务所有限责任公司':
        return 0
    if x['会计师事务所']=='立信羊城会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='五洲松德联合会计师事务所':
        return 0
    if x['会计师事务所']=='江苏苏亚金城会计师事务所有限公司':
        return 60
    if x['会计师事务所']=='江苏天华大彭会计师事务所':
        return 0
    if x['会计师事务所']=='深圳堂堂会计师事务所':
        return 0
    if x['会计师事务所']=='南京立信永华会计师事务所有限公司':
        return 0
    if x['会计师事务所']=='广东司农会计师事务所(特殊普通合伙)':
        return 0
    if x['会计师事务所']=='尤尼泰振青会计师事务所(特殊普通合伙)':
        return 20
    if x['会计师事务所']=='中审国际会计师事务所有限公司深圳分所':
        return 0


df.loc[:,'分数']=df.apply(get_score,axis=1)

# print(df['会计师事务所'].value_counts())


df.to_excel(os.path.join(path,'23-.xlsx'),index=False)